\section{Изоморфизм автоматов. Отличимость состояний автомата на входном слове и множестве входных слов. Неотличимость состояний и автоматов. Приведённый автомат. Теорема о существовании и единственности приведённого автомата.}

\begin{definition}
    Два автомата $V'(A, B, Q', F', G')$ и $V''(A, B, Q'', F'', G'')$ с одинаковыми входным и выходным алфавитами называются \textit{изоморфными}, если существует биекция $\varphi:Q'\to Q''$ такая, что $\varphi(G'(a, q)) = G''(a, \varphi(q))$ и $F'(a, q) = F''(a, \varphi(q))$ для любых $q\in Q'$, $a\in A$.
\end{definition}

\begin{definition}
    \textit{Слово} $w$ --- последовательность символов из $A$, $w\in A^n$, где $n$ --- какое-то натуральное число. Множество $A^+ = \bigcup_{n=1}^\infty A^n$ --- множество всех слов.
\end{definition}

\begin{definition}
    Пусть $V=(A, B, Q, F, G)$ --- конечный автомат. Функции выхода и переходов можно обобщить на функции: $\overline{F}:A^+\times Q\to B^+$ и $\overline{G}:A^+\times Q\to Q$, определяемые следующим рекурсивным образом:
    \begin{enumerate}[nolistsep]
        \item $\overline{F}(a, q) = F(a, q)$, $\overline{G}(a, q) = G(a, q)$ для $a\in A$.
        \item $\overline{F}(aw, q) = F(a, q)\overline{F}(w, G(a, q))$, $\overline{G}(aw, q) = \overline{G}(w, G(a, q))$ для $a\in A$, $w\in A^+$.
    \end{enumerate}
\end{definition}

\begin{definition}
    Пусть $V'(A, B, Q', F', G')$ и $V''(A, B, Q'', F'', G'')$ --- два автомата с одинаковыми входным и выходным алфавитами, $q'\in Q'$, $q''\in Q''$, $w\in A^+$.
    Состояния $q'$ и $q''$ \textit{отличимы на слове} $w$, если $\overline{F}'(w, q') \neq \overline{F}''(w, q'')$. В противном случае, $q'$ и $q''$ \textit{неотличимы на слове} $w$.
\end{definition}

\begin{definition}
    Пусть $W\subseteq A^+$ --- произвольное множество входных слов. Состояния $q'$ и $q''$ \textit{отличимы на множестве} $W$, если они отличимы хотя бы на одном слове из $W$, в противном случае, они \textit{неотличимы на множестве} $W$. Обозначение: $q'\stackrel{W}{\sim} q''$. В случае $W=A^+$ опускается фраза на множестве $W$ и обозначается $q' \sim q''$.
\end{definition}

\begin{remark}
    Отношение неотличимости на множестве $W$ --- это отношение эквивалентности.
\end{remark}

\begin{definition}
    Автоматы $V'$ и $V''$ называются \textit{неотличимыми} ($V'\approx V''$), если 
    \begin{enumerate}[nolistsep]
        \item $\forall q' \in Q' \quad \exists q'' \in Q'' \quad q' \sim q''$,
        \item $\forall q'' \in Q''\quad \exists q' \in Q' \quad q'' \sim q'$.
    \end{enumerate}
\end{definition}

\begin{remark}
    Изоморфные автоматы являются неотличимыми, неотличимые автоматы могут быть неизоморфными.
\end{remark}

\begin{definition}
    Автомат называется \textit{приведённым}, если любые два его состояния отличимы.
\end{definition}

\begin{theorem}
    Для любого конечного автомата $V$ существует единственный с точностью до изоморфизма приведённый автомат, неотличимый от $V$.
\end{theorem}

\begin{proof}
    Пусть $V=(A, B, Q, F, G)$ --- произвольный конечный автомат. Разобьём множество состояний $Q$ на классы эквивалентности относительно отношения неотличимости.
Пусть $\hat{Q}$ --- множество всех этих классов состояний автомата $V$. Построим новый автомат $\hat{V} = (A, B, \hat{Q}, \hat{F}, \hat{G})$.

Положим $\hat{G}(a, \hat{q}) = \hat{q}'$, $\hat{F}(a, \hat{q}) = F(a, q)$, где $q$ --- некоторое состояние из класса $\hat{q}$, а $\hat{q}'$ --- класс, содержащий состояние $G(a, q)$.

Корректность определения очевидна из неотличимости состояний из одного класса.

Пусть $q \in \hat{q}$. Покажем (индукцией по длине слова), что состояния $q$ и $\hat{q}$ неотличимы, т.\,е. $\overline{F}(w,q) = \overline{\hat{F}}(w, \hat{q})$ для любого слова $w \in A^+$.

\begin{enumerate}[nolistsep]
    \item База $w=a \in A$, тогда $\overline{\hat{F}}(a, \hat{q}) = \hat{F}(a, \hat{q}) = F(a, q) = \overline{F}(a, q)$.
    \item Пусть теперь длина слова $w$ больше 1 и $\overline{F}(w', q) = \overline{\hat{F}}(w', \hat{q})$ для любых состояний $q \in \hat{q}$ и любого слова $w'$ длины меньшей, чем длина $w$. Положим $w = aw'$, где $a \in A$. Тогда
\[
    \overline{F}(w, q) = F(a, q) \overline{F}(w', G(a, q)), \qquad \overline{\hat{F}}(w, \hat{q}) = \hat{F}(a, \hat{q}) \overline{\hat{F}}(w', \hat{G} (a, \hat{q})).
\]
\end{enumerate}

По предположению индукции $\overline{F}(w', G(a,q)) = \overline{\hat{F}}(w', \hat{G}(a,\hat{q}))$. Кроме того, $\hat{F}(a, \hat{q}) = F(a, q)$.

Таким образом, $\overline{F}(w, q) = \overline{\hat{F}}(w, \hat{q})$. Следовательно, автоматы $V$ и $\hat{V}$ неотличимы.

Построенный автомат $\hat{V}$ приведённый, т.\,е. все его состояния отличимы. В самом деле, состояния из разных классов эквивалентности отличимы.

Осталось показать единственность (с точностью до изоморфизма) приведённого автомата. 

Пусть $V' = (A, B, Q', F', G')$ --- приведённый автомат,
неотличимый от $V$. Покажем, что тогда $V'$ изоморфен $\hat{V}$.

Так как $V \approx \hat{V}$ и $V \approx V'$, то $V' \approx \hat{V}$. Поэтому для каждого состояния автомата $V'$ в $\hat{V}$ найдётся состояние, неотличимое от этого состояния, и, поскольку $V'$ является приведённым, то все эти состояния автомата $\hat{V}$ должны быть различными. Таким образом, число состояний автомата $\hat{V}$ не меньше числа состояний автомата $V'$. Аналогично число состояний автомата $V'$ не меньше числа состояний автомата $\hat{V}$. Следовательно, число состояний автомата $\hat{V}$ равно числу состояний автомата $V'$. А значит, между неотличимыми состояниями автоматов $V'$ и $\hat{V}$ существует биекция, которая и будет являться изоморфизмом.
\end{proof}