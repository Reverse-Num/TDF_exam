\section{Классы сохранения множеств функций и их свойства. Теорема Кузнецова о функциональной полноте функций $k$-значной логик.}

Пусть $A$ --- некоторое множество функций из $P_k$, удовлетворяющее следующим условиям:
\begin{enumerate}
    \item Каждая функция из $A$ зависит от одного и того же набора переменных $y_1$, $\ldots$, $y_p$, $p \geqslant 1$;
    \item Функции $g_i(y_1, \ldots, y_p) = y_i$, $i = 1, \ldots, p$ лежат в $A$.
\end{enumerate}

\begin{definition}
    Функция $f(x_1, \ldots, x_n)$ \textit{сохраняет множество функций $A$}, если $\forall h_1, \ldots h_n \in A$, функция $f(h_1, \ldots, h_n) \in A$. Обозначим $M_A$ --- множество всех функций, сохраняющих $A$.
\end{definition}

\begin{lemma}
    $M_A$ --- замкнутый класс.
\end{lemma}

\begin{proof}
    Множество $M_A$ содержит тождественную функцию. Поэтому достаточно показать, что если $f_0(z_1, \ldots, z_m) \in M_A$ и $f_1, \ldots, f_m \in M_A$, то и $f = f_0(f_1, \ldots, f_m)$ принадлежит множеству $M_A$.

    Возьмём произвольный набор функций $h_1, \ldots, h_n$ из $A$. Т.\,к. $f_i$ ($i = 1, \ldots, m$) сохраняет множество $A$, то $f_i(h_1, \ldots, h_n) \in A$, а значит, и $f_0(f_1(h_1, \ldots, h_n),\ldots, f_m(h_1, \ldots, h_n)) \in A$ --- сохраняет множество $A$, следовательно, $f_0(f_1,\ldots, f_m) \in M_A[\widetilde{x}]$.
\end{proof}

\begin{lemma}
    Если $[A][\widetilde{x}] = A$, то $(M_A)[\widetilde{x}] = A$.
\end{lemma}

\begin{proof}
    Рассмотрим $f(x_1, \ldots, x_p)$. Покажем включения в обе стороны:
    \begin{enumerate}
        \item $A\subseteq M_A[\widetilde{x}]$.
            Пусть $f \in A$. Для произвольных $h_1, \ldots, h_p \in A$, $g = f(h_1,\ldots, h_p) \in [A][\widetilde{x}]$.\\
            По условию $[A][\widetilde{x}] = A$, а значит, $f$ сохраняет $A$, $f \in M_A$.
        \item $M_A[\widetilde{x}] \subseteq A$. Пусть $f \in M_A[\widetilde{x}]$. Тогда $f$ зависит только от $x_1, \ldots, x_p$. Следовательно, 
        \[
            f(x_1, \ldots, x_p) = f(g_1(x_1, \ldots, x_p), \ldots, g_p(x_1, \ldots, x_p)),
        \]
        где $g_i(x_1, \ldots, x_p) = x_i$. Так как функция $f$ сохраняет множество $A$, а функции $g_1, \ldots, g_p$ лежат в множестве $A$, то $f(g_1, \ldots, g_p) \in A$, т.\,е. $f \in A$.
    \end{enumerate}
\end{proof}

\begin{theorem}[A.\,B.\,Кузнецов]
    Для любого $k \geqslant 2$ в $P_k$ существует конечное число замкнутых классов $M_1, \ldots, M_s$, таких, что ни один из них не содержится ни в одном из остальных и произвольная система $F$ из $P_k$ полна тогда и только тогда, когда $F$ целиком не содержится ни в одном из классов $M_1, \ldots, M_s$.
\end{theorem}

\begin{proof}
    Построим сначала систему классов. Пусть $A_1, \ldots, A_l$ --- система всех собственных подмножеств множества $(P_k)[x_1, x_2]$, таких, что для всех $i = 1, \ldots, l$ выполняются следующие условия:
    \begin{enumerate}[nolistsep]
        \item функции $g_1(x_1, x_2) = x_1$, $g_2(x_1, x_2) = x_2$ содержатся в $A_i$;
        \item $[A_i][x_1, x_2] = A_i$.
    \end{enumerate}
    Указанная система может быть построена путем перебора всех собственных подмножеств множества $P_k(2)$. Поскольку $\abs{P_k(2)} = k^{k^2}$, то число таких подмножеств не превышает $2^{k^{k^2}}$.

    Положим $G_i = M_{A_i}$. Из лемм следует, что $G_i$ --- замкнутый класс, такой, что $[G_i][x_1, x_2] = A_i$. Теперь из системы $G_i$ удалим классы, которые содержатся в каком-либо из других, получаем систему $M_1, \ldots, M_s$, где $M_i \neq P_k$, $M_i \neq M_j$ при всех $i,j = 1, \ldots, s$, $i\neq j$.

    Теперь покажем, что это искомая система классов. Пусть $F$ --- произвольная система из $P_k$. Если $F\subseteq M_i$, то $[F] \subseteq [M_i] = M_i \neq P_k$, то $F$ --- неполная система.

    Пусть $F$ --- не содержиться ни в одном из классов $M_i$. Положим
    $F_1 = F \cup \{g_1(x_1, x_2), g_2(x_1, x_2)\}$. Очевидно, что $[F] = P_k \Leftrightarrow [F_1] = P_k$. Положим $B=[F_1][x_1, x_2]$. Покажем, что $B$ содержат все функции из $P_k$ от переменных $x_1$ и $x_2$. Поскольку функции $g_1(x_1, x_2) = x_1$ и $g_2(x_1, x_2) = x_2$ содержатся в $B$, и $[B][x_1, x_2] = B$, то найдётся такое $i$, $1 \leqslant i \leqslant l$, что $B = A_i$. Так как каждая функция из $F_1$ сохраняет множество $B = [F_1][x_1, x_2]$, то $F_1 \subseteq G_i = M_{A_i}$. Поэтому найдётся такое $j$, $1 \leqslant j \leqslant s$, что $F_1 \subseteq M_j$. Получаем, что $F\subseteq M_j$, противоречие, а значит, $B = P_k[x_1, x_2]$, следовательно $[F][x_1, x_2]$ содержит $V_k(x_1, x_2)$. Значит, $F$ полна.
\end{proof}